---
title: ram-wipe againts RAM attacks
abstract: 'This post will introduce some of the very popular attacks that target
electronic devices - the RAM attacks, but the main topic will be the
verification of ram-wipe software solution protection from the attacks.'
cover: /covers/ram-wipe.png
author: daniil.klimuk
layout: post
published: true
date: 2025-04-14
archives: "2025"

tags:
  - RAM
  - wipe
  - Linux
  - dracut
  - warm
  - cold
  - boot
  - attack
categories:
  - Security

---

Hello there! This post will introduce some of the very popular attacks that
target electronic devices - the RAM attacks, but the main topic will be the
verification of [`ram-wipe` software
solution](https://github.com/kicksecure/ram-wipe) protection from the attacks.

## Introduction to RAM attacks

Here the focuse is on two types of attack: cold-boot and warm-boot attacks.

Warm-boot attacks focuse on reading data left in RAM by victim's operating
system or application using attacker's operating system or application without
disconnecting power from the device. For example, rebooting victim's operating
system via `systemctl reboot` (without breaking victim's system execution flow)
and booting some malware to dump or search RAM.

From [`thecyberwire.com`](https://thecyberwire.com/glossary/cold-boot-attack),
a cold boot attack is:

> A side-channel attack in which an attacker with physical access to a device
> retrieves encryption keys after a cold system reboot. A computer is "cold
> booted" when its power is quickly cycled without the machine shutting down
> cleanly or, in some cases, by hitting a reset on the device. See also
> data remanence.

As mentioned above, the key component of this attack is the cold boot, which
appears when a device shuts down due to power loss or when a hardware reset
(aka. hard reset, or the `hitting a reset on the device` from the definition
above) is performed. Then, the device is booted again.

The result of such power loss or hard reset is that the device execution flow
breaks, the tasks that should be executed during a normal shutdown sequence are
not being executed, and everything present in RAM before the shutdown stays
there for a specific for the hardware period of time (that could be extended)
and could be readen.

During such a cold boot, an attacker boots malware or a specific operating
system equipped with tools needed to read RAM and read it, gaining access to
all data and secrets present in RAM before the shutdown. By doing so, the
attacker can get access, among others, to keys that are used to encrypt certain
secrets and file systems.

Below is a graphical representation of the attacks:

![warm-vs-cold-boot-attcks-img](../../static/img/ram-wipe/warm-vs-cold-boot-attack.svg)

Legend:
* Initial state: platform has no power.
* Black arrows: standart boot/power off process.
* Red dashed arrows: malware boot process.
* 1: Platform executing firmware or bootloader code.
* 2: Firmware or bootloader boots operating system or application that
  manipulates secrets in RAM.
* 3: Malware in form of operating system or application that dumps secrets from
  RAM.

The only difference between the attacks is how the malware is being booted
(check the rad dashed arrows): from platform power off state or without powering
off platform.

## ram-wipe

## Testing methodology and tools

As `ram-wipe` is based on setting RAM to zeroes during Linux shutdown or reboot
workflows, to check, whether it succeeded or not the RAM should be checked after
Linux has finished executing. The main problem here is the way the RAM will be
checked. There are two ways: checking the RAM externally, that is, by software
that will not use the wiped RAM for execution (executing software in another RAM
or chip), or by making sure that the software load address and size will be
known, so to be able to conclude what has been overwritten and why some
addresses are not zeroed.

This post will use the second way by executing an EFI application after during
the early device boot stage. The problem with some EFI structures (e.g. logs)
being randomly loaded into RAM was solved by checking, where those structures
are being written before every test. During checking the application record the
addresses in memory modified by firmware and excludes it from dumping.

The exact application workflow could be presented as following flow diagram:

TODO

The application can be found [here](https://github.com/zarhus/ram-dump-efi). It
is a simple application that runs automatically during boot and dumps specified
RAM range values into files. The application was written as minimalistic as
possible to prevent it from modifying RAM.

The final testing methodology using the application is as follows:
1. Boot to the application and choose option 1 to write the pattern.
2. Reboot to the application and choose option 2 to exclude RAM modified by
  firmware.
3. Reboot to OS and run `ram-wipe`.
4. Boot to the application and dump memory.

It **is important** to note, that the booting to the OS was set as automatic
by changing Dasharo firmware boot order. But the application was booted by
chosing the needed drive in `One Time Boot` menu. When bootign the application
by manually choosing the hard drive it **is important to make exaclty the same
steps every time**, that is, making the same amount of keyboard klicks and
visiting the same pages. Otherwise firmware will generate another set of data in
RAM and make the second step from above useless.

Requirements for hardware are rather small: the ability to run EFI applications
and as little RAM as possible to reduce the time needed to dump RAM. Because the
`ram-wipe` is a software solution and therefore  does not depend on hardware -
the Qemu with [Dasharo
Firmware](https://docs.dasharo.com/variants/qemu_q35/releases/) is being used
as test platform.

As an operating system, the Debian Trixie test release with encrypted `rootfs`
was used. To install and reproduce the results, follow the following steps:

1. Install Debian Trixie following instructions from [Debian Testing
  article](https://wiki.debian.org/DebianTesting) with one LUKS-protected
  partition.
2. Migrate to `dracut`:

  ```bash
  $ sudo apt install dracut
  $ sudo dracut -f
  ```

3. Verify that `dracut` is being used by checking system logs, e.g.:

  ```bash
  $ sudo dmesg
  (...)
  [  OK  ] Finished dracut-initqueue.service - dracut initqueue hook.
  (...)
         Starting dracut-pre-pivot.service - dracut pre-pivot and cleanup hook...
  [  OK  ] Finished dracut-pre-pivot.service - dracut pre-pivot and cleanup hook.
  (...)
  [  OK  ] Stopped dracut-pre-pivot.service - dracut pre-pivot and cleanup hook.
  (...)
  ```

4. Compile and install
[`ram-wipe`](https://github.com/kicksecure/ram-wipe?tab=readme-ov-file#how-to-build-deb-package-from-source-code)
package and its dependency -
[`helper-scripts`](https://github.com/Kicksecure/helper-scripts?tab=readme-ov-file#how-to-build-deb-package-from-source-code):

  ```bash
  $ sudo apt install build-essential debhelper debhelper-compat dh-python\
  dh-apparmor config-package-dev
  $ git clone https://github.com/Kicksecure/helper-scripts.git
  $ cd helper-scripts
  $ git checkout 37a9ef2e84e352e37b7e84bd8ed36e5d31218778
  $ dpkg-buildpackage -b
  $ cd -
  $ sudo apt install ./helper-scripts_31.3.-1_all.deb
  $ git clone https://github.com/Kicksecure/helper-scripts.git
  $ cd ram-wipe
  $ git checkout ed9c2978b2c69cebd37b3e1412b648d8f00584e4
  $ dpkg-buildpackage -b
  $ cd -
  $ sudo apt install ./ram-wipe_3.3-1_all.deb
  $ sudo dracut -f
  ```

  > Note: Do not mind the `failed to sign` issues, these will appear if GPG key
  > is not configured properly and is not important here.

5. Verify that `ram-wipe` is being launched during reboot or shutdown by
  checking system logs. For the first stage check for following logs:

  ```bash
  (...)
[   66.353653] wipe-ram-shutdo (4396): drop_caches: 3
[   66.359901] dracut INFO: wipe-ram.sh: First RAM wipe pass completed, OK. (1/2)
[   66.368166] dracut INFO: wipe-ram.sh: Checking if there are still mounted encrypted disks...
[   66.379157] dracut INFO: wipe-ram.sh: Success, there are no more mounted encrypted disks, OK.
[   66.388631] dracut INFO: wipe-ram.sh: Now running 'kexec --exec'..
  (...)
  ```

## ram-wipe analisys

### How does it work?



### Running first stage only

### Running second stage only

### Running both stages

> remove unused categories
> remember about newlines before lists, tables, quotes blocks (>) and blocks of
> text (\`\`\`)
> copy all post images to `blog/static/img` directory. Example usage:

![alt-text](/img/file-name.jpg)

> example usage of asciinema videos:

[![asciicast](https://asciinema.org/a/xJC0QaKuHrMAPhhj5KMZUhMEO.svg)](https://asciinema.org/a/xJC0QaKuHrMAPhhj5KMZUhMEO?speed=1)

> embed responsive YouTube player (copy the address after `v=`):

{{< youtube UQ-6rUPhBQQ >}}

> embed vimeo player (extract the `ID` from the video’s URL):

{{< vimeo 146022717 >}}

> embed Instagram post (you only need the photo’s `ID`):

{{< instagram BWNjjyYFxVx >}}

> embed Twitter post (you need the `URL` of the tweet):

{{< tweet user="3mdeb_com" id="1247072310324080640" >}}

## Summary

Summary of the post.

OPTIONAL ending (may be based on post content):

Unlock the full potential of your hardware and secure your firmware with the
experts at 3mdeb! If you're looking to boost your product's performance and
protect it from potential security threats, our team is here to help.
[Schedule a call with us](https://calendly.com/3mdeb/consulting-remote-meeting)
or drop us an email at `contact<at>3mdeb<dot>com` to start unlocking the hidden
benefits of your hardware. And if you want to stay up-to-date on all things
firmware security and optimization, be sure to
[sign up for our newsletter](https://3mdeb.com/subscribe/3mdeb_newsletter.html).
Don't let your hardware hold you back, work with 3mdeb to achieve more!
